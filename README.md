# Contact Card Server

A minimalist contact management workflow using three classic 1980s technologies.

## System Overview

**Data Flow:**
```
[BANCstar Input] → contact.txt → [Smalltalk Display] → [PostScript Print]
```

**Components:**
1. **BANCstar/xBase** - Text-based data entry form
2. **contact.txt** - Plain text storage (2 lines)
3. **Smalltalk-80** - GUI viewer window
4. **PostScript** - Printable business card

---

## Quick Start

### Prerequisites
- **BANCstar alternative:** Clipper 5.x, FoxPro 2.x, or xBase compiler
- **Smalltalk-80 alternative:** Squeak, Pharo, or GNU Smalltalk
- **PostScript:** Ghostscript 8.0+ (`gs` command)

### Installation
```bash
# Clone or download files
mkdir contact-card-server
cd contact-card-server

# Place these files:
# - contact_entry.prg  (BANCstar/xBase code)
# - contact_viewer.st  (Smalltalk code)
# - business_card.ps   (PostScript template)
```

---

## Usage Guide

### Step 1: Enter Contact (BANCstar/xBase)

**Compile and run (Clipper example):**
```bash
clipper contact_entry
blinker contact_entry
./contact_entry
```

**Or interpret (FoxPro/dBase):**
```bash
foxpro
DO contact_entry.prg
```

**What you'll see:**
```
        Contact Card Server - Entry
        ==============================
        
    Name:    [____________________________]
    
    Phone:   [____________________________]
    
              [S]ave   [E]xit
              
Choice: _
```

**Usage:**
1. Type a name (required, auto-uppercase)
2. Tab to phone field
3. Type phone number (required)
4. Press 'S' to save or 'E' to exit
5. File `contact.txt` is created

**Features:**
- Both fields are required
- Input is trimmed automatically
- CRLF line endings for compatibility
- Confirms save with message
- Form clears after save

---

### Step 2: View Contact (Smalltalk-80)

**Method A - File it in:**
```smalltalk
"In Squeak/Pharo workspace:"
FileStream fileIn: 'contact_viewer.st'
```

**Method B - Copy and evaluate:**
```smalltalk
"Open contact_viewer.st in workspace"
"Select all (Cmd+A / Ctrl+A)"
"Do it (Cmd+D / Ctrl+D)"
```

**What happens:**
- Window opens: "Contact Information"
- Shows name and phone from contact.txt
- Window size: 300x120 pixels
- Error handling if file missing

**Troubleshooting:**
If window doesn't appear, use Transcript version:
```smalltalk
| f n p |
[
  f := FileStream oldFileNamed: 'contact.txt'.
  n := f nextLine. p := f nextLine. f close.
] on: Error do: [:e | n := 'Error'. p := 'File not found'].
Transcript clear; 
  show: '=== Contact Card Server ==='; cr; cr;
  show: 'Name: ', n; cr;
  show: 'Phone: ', p; cr.
```

---

### Step 3: Print Card (PostScript)

**Edit the template:**
1. Open `contact.txt` - note the name and phone
2. Open `business_card.ps` in text editor
3. Find **Line 58**: `(John Smith) show`
4. Replace `John Smith` with actual name from contact.txt
5. Find **Line 68**: `(555-1234) show`
6. Replace `555-1234` with actual phone from contact.txt
7. Save file

**Generate PDF:**
```bash
gs -dNOPAUSE -dBATCH -sDEVICE=pdfwrite \
   -sOutputFile=business_card.pdf business_card.ps
```

**Preview:**
```bash
gs business_card.ps
# Or
evince business_card.pdf
```

**Print:**
```bash
lpr business_card.ps
# Or
lp business_card.pdf
```

---

## File Specifications

### contact.txt Format
```
NAME
PHONE
```

**Example:**
```
JOHN SMITH
555-1234
```

**Details:**
- Plain ASCII text file
- Exactly 2 lines
- Line 1: Contact name (max 30 chars)
- Line 2: Phone number (max 20 chars)
- CRLF (Windows) or LF (Unix) line endings
- No headers, no trailing lines

---

## Example Session

### 1. BANCstar Entry
```
        Contact Card Server - Entry
        ==============================
        
    Name:    JANE DOE                    
    
    Phone:   555-9876                    
    
              [S]ave   [E]xit
              
Choice: S

            Contact saved to contact.txt
            Press any key to continue...
```

### 2. Generated contact.txt
```
JANE DOE
555-9876
```

### 3. Smalltalk Window Output
```
┌─────────────────────────────┐
│ Contact Information         │
├─────────────────────────────┤
│                             │
│ Name: JANE DOE              │
│ Phone: 555-9876             │
│                             │
└─────────────────────────────┘
```

### 4. Business Card (ASCII Preview)
```
╔═════════════════════════════════════╗
║ ┌─────────────────────────────────┐ ║
║ │                                 │ ║
║ │  JANE DOE                       │ ║
║ │  ──────────────────────────     │ ║
║ │                                 │ ║
║ │  Phone: 555-9876                │ ║
║ │                                 │ ║
║ │  ☎                              │ ║
║ │                                 │ ║
║ │  Generated by Contact Card      │ ║
║ │  Server                         │ ║
║ │                                 │ ║
║ └─────────────────────────────────┘ ║
╚═════════════════════════════════════╝
```
*Actual size: 3.5" × 2.0" (252pt × 144pt)*

---

## Troubleshooting

### BANCstar/xBase Errors

**Error: "Variable not found: M_NAME"**
```
Solution: Use PUBLIC declaration at top of file
Add: PUBLIC M_NAME, M_PHONE
```

**Error: "File access denied"**
```
Solution: Check directory permissions
Try: SET DEFAULT TO C:\TEMP
Or run from writable directory
```

**Error: "Cannot create contact.txt"**
```
Solution: Check if file is open elsewhere
Close any editors viewing contact.txt
```

### Smalltalk Errors

**Error: "FileStream class does not understand oldFileNamed:"**
```
Solution: Use alternative file reading:
file := StandardFileStream readOnlyFileNamed: 'contact.txt'.
```

**Error: "Window does not appear"**
```
Solution 1: Check if image has windowing support
  Smalltalk hasWindows

Solution 2: Use Transcript alternative (see code comments)

Solution 3: Try in Squeak/Pharo instead of GNU Smalltalk
```

**Error: "contact.txt not found"**
```
Solution: Check working directory
  FileDirectory default pathName
  
Copy contact.txt to Smalltalk image directory
```

### PostScript Errors

**Error: "Undefined in rectstroke"**
```
Solution: Ensure %%BeginProlog section is intact
PostScript must be processed in order
```

**Error: "Font not found: Helvetica"**
```
Solution: Install PostScript standard fonts
Ubuntu/Debian: apt-get install gsfonts
RHEL/CentOS: yum install urw-fonts
```

**Error: "Syntax error near show"**
```
Solution: Check parentheses are balanced
Correct: (John Smith) show
Wrong: (John Smith show
Wrong: John Smith) show
```

---

## Technical Details

### BANCstar/xBase Code
- **Compatible with:** Clipper 5.x, FoxPro 2.x, dBase IV
- **File I/O:** Low-level functions (FCREATE, FWRITE, FCLOSE)
- **Line endings:** CHR(13)+CHR(10) for CRLF
- **Memory variables:** PUBLIC scope for persistence
- **Validation:** VALID clause on GET statements
- **Character mode:** @ row,col syntax for positioning

### Smalltalk-80 Code
- **Compatible with:** Squeak 5.x, Pharo 7+, GNU Smalltalk
- **Error handling:** Exception blocks with on:do:
- **File reading:** FileStream with automatic close
- **GUI:** StandardSystemView with ScrollableView
- **Nil safety:** ifNil: checks on all reads
- **String handling:** Uses String cr for line breaks

### PostScript Code
- **Level:** PostScript Level 2 (1991+)
- **DSC compliant:** Document Structuring Conventions 3.0
- **Units:** Points (1 inch = 72 points)
- **Procedures:** Defined in Prolog for reusability
- **State management:** gsave/grestore for isolation
- **Fonts:** Uses standard 14 PostScript fonts

---

## Code Architecture

### Data Flow
```
┌─────────────┐
│  BANCstar   │  User enters name + phone
│   (Input)   │  ↓
└──────┬──────┘  Validates required fields
       │         ↓
       ↓         Writes CRLF-terminated lines
┌─────────────┐
│ contact.txt │  NAME\r\n
│  (Storage)  │  PHONE\r\n
└──────┬──────┘
       │
       ├─────────────────────┐
       ↓                     ↓
┌─────────────┐      ┌─────────────┐
│ Smalltalk   │      │ PostScript  │
│  (Display)  │      │   (Print)   │
└─────────────┘      └─────────────┘
  Reads 2 lines        Manual edit
  Opens window         Generate PDF
```

### Error Handling Strategy
1. **BANCstar:** Validates before write, checks file handle
2. **Smalltalk:** Exception blocks, nil checks, fallback display
3. **PostScript:** No runtime errors (template substitution)

---

## Historical Context

### BANCstar (1982)
- **Origin:** Unisys banking systems
- **Language:** xBase derivative with extensions
- **Use case:** Branch teller applications
- **Interface:** Character-mode forms on terminals

### Smalltalk-80 (1980)
- **Origin:** Xerox PARC (Alan Kay et al.)
- **Paradigm:** Pure object-oriented programming
- **Innovation:** First GUI with windows, icons, menus
- **Legacy:** Influenced Java, Ruby, Python

### PostScript (1984)
- **Creator:** Adobe Systems (John Warnock, Chuck Geschke)
- **Purpose:** Device-independent page description
- **Impact:** Enabled desktop publishing revolution
- **Standard:** Adobe Type 1 fonts, PDF ancestor

---

## Known Limitations

### Functional
- ✗ Stores only one contact (overwrites previous)
- ✗ No search or list functionality
- ✗ No data validation (format checking)
- ✗ No backup or versioning

### Technical
- ✗ BANCstar: Character-mode only, no mouse support
- ✗ Smalltalk: Requires windowing environment
- ✗ PostScript: Manual editing required (no automation)

### Compatibility
- ✗ contact.txt must be in working directory for all tools
- ✗ Different line ending handling (CRLF vs LF)
- ✗ Font availability varies by PostScript implementation

---

## Future Enhancements

### While Staying Retro

**BANCstar additions:**
```
* Multiple contacts using indexed DBF files
* Browse screen with cursor navigation
* Export to CSV format
* Backup to dated files
```

**Smalltalk additions:**
```
* Contact class with accessors
* OrderedCollection of contacts
* List browser with selection
* Edit and save back functionality
```

**PostScript additions:**
```
* Automatic text substitution via sed/awk
* 4-up layout (4 cards per page)
* Color variations for card background
* Barcode generation (Code 39)
```

---

## Complete File Listing

### contact_entry.prg (xBase)
- Lines: ~70
- Functions: SAVE_CONTACT
- Variables: M_NAME, M_PHONE, M_CHOICE

### contact_viewer.st (Smalltalk)
- Lines: ~35
- Classes used: FileStream, StandardSystemView, ScrollableView
- Error handling: on:do: blocks

### business_card.ps (PostScript)
- Lines: ~85
- Procedures: rectstroke, centertext
- Fonts: Helvetica, Helvetica-Bold

---

## License

**Public Domain** - Free for educational and personal use

No warranty provided. Use at your own risk.

---

## Credits

**Contact Card Server** - A retro computing demonstration

**Technologies:**
- BANCstar © Unisys Corporation (1982)
- Smalltalk-80 © Xerox Corporation (1980)  
- PostScript © Adobe Systems (1984)

**Created for:** Historical computing education

---

## Support Resources

### Documentation
- **xBase/Clipper:** Norton Guide files, Clipper 5.x manuals
- **Smalltalk:** "Smalltalk-80: The Language" (Goldberg & Robson)
- **PostScript:** "PostScript Language Reference" (Adobe Red Book)

### Modern Alternatives
- **xBase → Harbour:** Open-source Clipper compiler
- **Smalltalk → Pharo:** Modern Smalltalk environment
- **PostScript → PDF:** Direct PDF generation

### Community
- comp.lang.clipper (Usenet archive)
- squeak-dev mailing list
- PostScript Language forum

---

## Appendix: Testing Checklist

### Pre-flight Check
- [ ] All three source files in same directory
- [ ] Directory is writable
- [ ] Required tools installed and in PATH
- [ ] No existing contact.txt (or backup made)

### BANCstar Test
- [ ] Compiles without errors
- [ ] Form displays correctly
- [ ] Name field accepts input
- [ ] Phone field accepts input
- [ ] Validation works (empty fields rejected)
- [ ] Save creates contact.txt
- [ ] File contains exactly 2 lines
- [ ] Exit closes cleanly

### Smalltalk Test
- [ ] Script loads without errors
- [ ] contact.txt is found and read
- [ ] Window opens (or Transcript shows output)
- [ ] Name displays correctly
- [ ] Phone displays correctly
- [ ] Error handling works (test with missing file)

### PostScript Test
- [ ] File has correct line endings (Unix LF or DOS CRLF)
- [ ] Edit locations identified (lines 58, 68)
- [ ] Substitution done correctly
- [ ] gs processes without errors
- [ ] PDF generates successfully
- [ ] Output is 3.5" × 2.0"
- [ ] Text is readable and positioned correctly

---

**End of Documentation**

For questions or issues, refer to the Troubleshooting section above.
